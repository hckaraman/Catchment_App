<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">
        <head>
            <meta content=\"text/html; charset=iso-8859-1\" http-equiv=\"content-type\">
            <title>Hypsometric Analysis</title><style type="text/css">
            h1 {
                font-size: 14pt;
                margin-left: 15px;
                margin-right: 15px;
                text-align: center;
                font-family: Helvetica, Verdana, Geneva, Arial, sans-serif;
            }
            h2 {
                font-size: 12pt;
                margin-left: 15px;
                margin-right: 15px;
                text-align: center;
                font-family: Helvetica, Verdana, Geneva, Arial, sans-serif;
            }
            p {
                font-size: 12pt;
                font-family: Helvetica, Verdana, Geneva, Arial, sans-serif;
                margin-left: 15px;
                margin-right: 15px;
            }
            caption {
                font-family: Helvetica, Verdana, Geneva, Arial, sans-serif;
                font-size: 12pt;
                margin-left: 15px;
                margin-right: 15px;
            }
            table {
                font-size: 12pt;
                font-family: Helvetica, Verdana, Geneva, Arial, sans-serif;
                font-family: arial, sans-serif;
                border-collapse: collapse;
                align: center;
            }
            td, th {
                border: 1px solid #222222;
                text-align: centre;
                padding: 8px;
            }
            tr:nth-child(even) {
                background-color: #dddddd;
            }
            tr:hover {
                background-color: lightyellow;
            }
            .numberCell {
                text-align: right;
            }
            .header {
                font-weight: bold;
                text-align: center;
            }
        </style></head>
        <body>
            <h1>Hypsometric Analysis</h1><p><strong>Input DEM</strong>: DEM_UTM42</p><div id='graph' align="center">
    <script>
      var plot = {
        dataX: [[99.99999606734792, 99.99996722789938, 99.99987677690166, 99.99976535175954, 99.9996368851251, 99.99943500898526, 99.99894342747592, 99.99744246526737, 99.9916640884855, 99.95295761588159, 99.75809863822876, 99.34707750663408, 98.95350293052712, 98.64266217788516, 98.30249694960564, 97.98680592607147, 97.72442069052677, 95.9476012913204, 94.96478827866233, 93.21458113604592, 90.45601054024166, 87.7896095111138, 85.81226942615095, 84.14028404418576, 82.58062307078018, 81.17767566078615, 79.80539376078718, 78.49150125702636, 77.32660776419043, 76.23632716828509, 75.19581166261794, 74.1365780439589, 73.06701334829944, 72.09121487605874, 71.17420037614768, 70.23479073355483, 69.18823336341681, 67.31994047695126, 66.17085493457188, 65.01468144226973, 63.95423132323557, 63.02051878261504, 62.1703226632224, 61.341528036420655, 60.535879688847, 59.737650944854394, 58.92383447892144, 58.12957640264034, 57.36670744433603, 56.644890130156234, 55.95333326280778, 55.29683205605382, 54.65648094048693, 54.05137032016205, 53.47430868531848, 52.91490465829062, 52.37686279733291, 51.85329047424232, 51.354107148435425, 50.89060608578695, 50.4524889813971, 50.02796836611376, 49.614699068416336, 49.19954340860705, 48.80274930133487, 48.416476349246715, 48.05059288728224, 47.6925013199619, 47.3443528079706, 47.003909672277814, 46.672071179324625, 46.34258834496422, 46.02169704450316, 45.70792122252939, 45.40095282129705, 45.09783055379384, 44.796028346503725, 44.505506296248065, 44.22242875636996, 43.94444531181271, 43.67183255910556, 43.40607966250085, 43.14232062049804, 42.885903839918825, 42.630851689609564, 42.385809449714614, 42.14338897786951, 41.90309869256491, 41.669202899533886, 41.436172289959316, 41.204527284799084, 40.97609656726797, 40.74891118956053, 40.52311534891951, 40.29588015761912, 40.0679016950766, 39.83478849980846, 39.60541787843147, 39.37953551944481, 39.15671276377232, 38.933921469316424, 38.71466169642367, 38.49611504444047, 38.27611855472571, 38.064925962122345, 37.85566430168769, 37.64762569604828, 37.442055485027815, 37.23674089639219, 37.034118863543775, 36.82935484619863, 36.629865826169784, 36.43353603664099, 36.23811337885745, 36.04537016802085, 35.85264268779256, 35.659715953192475, 35.472994943566384, 35.29458231689024, 35.12182746566569, 34.95252679384679, 34.787008022439814, 34.62465634683704, 34.46241085284031, 34.303286573706906, 34.14597131452789, 33.99248383670166, 33.84059432650181, 33.68723531531002, 33.532554933021096, 33.374429547514694, 33.21976882848615, 33.068458729025316, 32.91956589970644, 32.77321618539592, 32.628722682864684, 32.4884712010381, 32.34676201617581, 32.20532680607473, 32.06458636450685, 31.92394686100889, 31.784032276376717, 31.646221660604546, 31.51158600594074, 31.3093205335471, 31.17525904608621, 31.044001539554632, 30.912538224231145, 30.783842185084264, 30.655410944510418, 30.52711341410712, 30.397916617262723, 30.26677840117742, 30.136749192977184, 30.00915953994735, 29.88325568377356, 29.757109314055164, 29.632486191573715, 29.508262888719884, 29.38548811271359, 29.262742176155832, 29.140611044205777, 29.01944865555014, 28.897945437048012, 28.775771045925136, 28.65430715394376, 28.53648096513155, 28.419544866572256, 28.3039196520379, 28.190998791246948, 28.079298363483208, 27.968425103539197, 27.858760478666156, 27.749923021612844, 27.640462894647698, 27.53135277371721, 27.421287018332542, 27.3113379316261, 27.198350215749876, 27.089376426757983, 26.981290106250956, 26.873319143538122, 26.76814822910252, 26.664174151781673, 26.56004801191394, 26.456545852842073, 26.35400457176047, 26.252080717054614, 26.15117279746807, 26.05080102944771, 25.950742562709316, 25.850251504242692, 25.750937619630456, 25.65136942351738, 25.553582718794175, 25.456418683982818, 25.3605353828638, 25.26486706672487, 25.169299688655865, 25.074067896897244, 24.979429935601903, 24.886102858331494, 24.793030092561917, 24.699831481925948, 24.606656467202427, 24.514215547532856, 24.42120832596453, 24.32753517531153, 24.23456596937993, 24.14244097276037, 24.050579463829823, 23.959011592920852, 23.8676809920204, 23.777983752614993, 23.68761534058884, 23.597982334500667, 23.507511673520554, 23.417975672850222, 23.32802805459606, 23.238337369610797, 23.149231338900634, 23.06128019701643, 22.973595164589288, 22.886781870038718, 22.80018487135227, 22.71455923772828, 22.629831559661362, 22.545114368666653, 22.460760292546844, 22.375990666191125, 22.291488460176502, 22.206971834437606, 22.1228288106458, 22.03842361004902, 21.953981704699544, 21.87004842235173, 21.785951279500804, 21.701877732562323, 21.618312808625518, 21.53463777043062, 21.449798667221586, 21.365575679504268, 21.2814287230604, 21.19819152012983, 21.11510244709407, 21.03230832296391, 20.94896624931134, 20.864946448617893, 20.78097777240141, 20.69676527175629, 20.6131964151674, 20.53031577269161, 20.44758457099466, 20.365186333840025, 20.282430225346605, 20.199387033251714, 20.116547028180687, 20.033537919070454, 19.9499022073963, 19.864840253903026, 19.780660525358527, 19.69742463331199, 19.61329734012849, 19.52829699818439, 19.443068562419953, 19.358641076794747, 19.273673506951273, 19.18926830635449, 19.10572697833013, 19.0221712305815, 18.93961568734388, 18.857041791729923, 18.775249182994813, 18.693455263375668, 18.61246229389577, 18.53094890345797, 18.44948794838116, 18.36805714363693, 18.286227830149127, 18.203393068614204, 18.12130682185751, 18.039020009844997, 17.957123841271926, 17.875099206064405, 17.793247607548167, 17.711797139543563, 17.631644446723637, 17.551761796012844, 17.472513613170104, 17.39300063175434, 17.31318614701284, 17.23423029130766, 17.15542780903341, 17.076412963547106, 16.996932754231963, 16.91753119795831, 16.838532083080317, 16.760171368722453, 16.681914214202564, 16.603928412675838, 16.525850849267353, 16.447697254585435, 16.369221182433378, 16.29147789445127, 16.21345669905586, 16.135005533700276, 16.056975162116704, 15.979353786348893, 15.902258075075093, 15.825550385472653, 15.749368360364224, 15.673441957640645, 15.597162927114361, 15.521119855712573, 15.4455827855444, 15.369990658247168, 15.294394598297878, 15.21831613302741, 15.142480181301554, 15.066641607807652, 14.991740316391555, 14.917115621504728, 14.842036049861251, 14.767577837245593, 14.692829919260419, 14.618875086110329, 14.54441687349467, 14.469838059548712, 14.396222745361076, 14.3224370162502, 14.248185923310475, 14.175646844907309, 14.103269005239195, 14.031191358012796, 13.959938256838067, 13.88922917253369, 13.818724586137199, 13.748509705110212, 13.677992009873474, 13.608020953275124, 13.537883414405616, 13.468396074012457, 13.398709479247517, 13.329422704110183, 13.259783301170136, 13.190457199512052, 13.12211688264071, 13.053569446093427, 12.984437355271028, 12.916507345099493, 12.847084238023553, 12.779557980131695, 12.712102509977175, 12.645187124040923, 12.579028118187052, 12.51212977374312, 12.44661834459756, 12.38030072177667, 12.315220573475315, 12.250137803405913, 12.185238557099986, 12.121020970487029, 12.056293449988376, 11.992071930723347, 11.928685444582188, 11.865728928401209, 11.803149946819403, 11.739798854546912, 11.676909193451202, 11.61438133634637, 11.551768271779917, 11.489232549370943, 11.426653567789135, 11.364884712534739, 11.303184023249624, 11.242195143990052, 11.182041297854362, 11.121735389171771, 11.06149240292239, 11.001077690865735, 10.941355125574237, 10.881093786948492, 10.82122702441426, 10.761512324426914, 10.70148170138956, 10.642067193843918, 10.58285980597422, 10.523862159548504, 10.46527875247467, 10.406809392311, 10.349227500632207, 10.291509277014821, 10.233570824881244, 10.176947189424668, 10.120157071696923, 10.063905727303435, 10.00735419046822, 9.951257530389668, 9.895467617172937, 9.839397174774888, 9.783191711322258, 9.727763602096417, 9.672584560835308, 9.606010004745535, 9.55048882275391, 9.495709601120407, 9.440851726445398, 9.38609610072434, 9.331267065497883, 9.276438030271429, 9.222517437674249, 9.168763327348229, 9.115795747437161, 9.062720675036061, 9.009430617654868, 8.956383073818275, 8.904299029740015, 8.851851870786842, 8.7993798050372, 8.747298382726987, 8.695348048819262, 8.64358648221113, 8.59253279297645, 8.540873475322265, 8.489455360328657, 8.437856343339611, 8.386354331768409, 8.335426487400133, 8.284796213705503, 8.234205266531625, 8.18351600305588, 8.133381243522674, 8.0836371274289, 8.034395079916667, 7.984898720903599, 7.935933269920625, 7.887075311427704, 7.838566048085404, 7.790035810598706, 7.742125621255791, 7.693792016372836, 7.646163667095285, 7.598060777800719, 7.550022121823363, 7.502798835709513, 7.454977786480299, 7.407633899036159, 7.360094689872298, 7.312236935890393, 7.2651198313825605, 7.217998794222657, 7.171206788953011, 7.124756924413866, 7.078181215008328, 7.032042029983088, 6.985866140205155, 6.939605042965602, 6.89444246653893, 6.848994117394824, 6.804290350376885, 6.759783215962678, 6.716212052742265, 6.672984341136379, 6.630020117219515, 6.587308893919452, 6.544806101179345, 6.502419977117468, 6.46031438223692, 6.4182782642096985, 6.376324731876037, 6.334477381148407, 6.2923495012394355, 6.250970136108691, 6.209417734286671, 6.167784057655091, 6.12600094024468, 6.083270053684242, 6.041580009039594, 6.00014427589578, 5.957915457916895, 5.915993386799833, 5.874185362592943, 5.83206010445203, 5.790060691177501, 5.748733761407754, 5.707371437769337, 5.666457436467454, 5.625522461021159, 5.5847828072945855, 5.544495408556605, 5.50441644037859, 5.463817051242681, 5.423563735489346, 5.383672223726899, 5.34390786771487, 5.304902513553267, 5.265284976552021, 5.226789556276112, 5.188427846170751, 5.1504777536492075, 5.112279904046957, 5.074603786286625, 5.0365671754194485, 4.999094244682977, 4.961762889421206, 4.924112989341367, 4.886667587169424, 4.84986845082177, 4.812893656014772, 4.775619979650103, 4.738364655661764, 4.701182741178833, 4.6644163769318014, 4.627871552084983, 4.591078970157447, 4.554506616746101, 4.518048310244927, 4.481898061489609, 4.446411120050908, 4.4106816650675835, 4.374492089791515, 4.339102153770657, 4.303619144984028, 4.268112540284941, 4.232940211012215, 4.198547857734313, 4.163652124990847, 4.129515394097815, 4.0953983264651495, 4.06110560037315, 4.02727168368987, 3.9929881337860462, 3.959531751701939, 3.9256244255132744, 3.892419733161956, 3.858893874224534, 3.825919897461605, 3.7927388010227325, 3.7597569589556623, 3.726914070595222, 3.6939663115127863, 3.661120801384299, 3.6279043110767684, 3.595040448571929, 3.562238197616263, 3.5294962473257474, 3.497079396273406, 3.4649456961704628, 3.433144960609835, 3.4017047181560622, 3.3697742050769808, 3.338415237432757, 3.306757388230852, 3.2751349328976165, 3.2435019904921814, 3.212216432353354, 3.181181253063292, 3.15008577310808, 3.1189195054155183, 3.0877624139111326, 3.056420487759237, 3.025406282613563, 2.9946162386361608, 2.9633700070180846, 2.9326363310537507, 2.901324555234419, 2.870314282740827, 2.8390588749345746, 2.808161338467119, 2.7774224189666907, 2.7463308716635493, 2.7151436298265885, 2.6836588173159703, 2.65140189411468, 2.618958825381845, 2.5861919682948487, 2.55311836434603, 2.5199556202835094, 2.4866984925712043, 2.453303722036271, 2.4192954577776815, 2.385704054639004, 2.3525570411847885, 2.3185146939415535, 2.2846021242167724, 2.251244058434543, 2.2182569728313672, 2.1856028517705184, 2.154145567824428, 2.123031735492864, 2.092452743843465, 2.0612183101816117, 2.0304584165367845, 2.000024933014155, 1.9695586773909035, 1.9390662040871587, 1.9085842178556023, 1.8781769520134772, 1.8477657535192704, 1.8174817107754926, 1.7876958039611757, 1.7583582194833802, 1.7294964859066453, 1.7011735256641347, 1.6727732232641679, 1.644321796387227, 1.615378788000943, 1.5867910291854082, 1.558494286623402, 1.5301621501927265, 1.5015901219854966, 1.4728398135508636, 1.4443608581094058, 1.4160536284752, 1.38782636276652, 1.3605429335557861, 1.3332398410846769, 1.3061451791735346, 1.2801765666397902, 1.2548765049587685, 1.2299631540650946, 1.206053940334506, 1.1831449311149433, 1.160561021133566, 1.1385748742675394, 1.1170344279699984, 1.0953864891824039, 1.0738748823334143, 1.0525507318999816, 1.03137995489746, 1.0106810961439172, 0.9900451598235716, 0.9695730840063366, 0.9495611284818573, 0.9295884994781178, 0.9098872234675426, 0.8905857670845618, 0.8714743888852072, 0.8525321147250575, 0.8337405922277719, 0.8153331587497981, 0.7974867836344934, 0.7791291637494591, 0.761365374327716, 0.7440040263016257, 0.7266584088838401, 0.7099983838110835, 0.6933803070271249, 0.6770925730174571, 0.6612151457075832, 0.6455251748132662, 0.6301013133760192, 0.6144939281752748, 0.5993532176874039, 0.5845743111904222, 0.5697337931442559, 0.555308825334, 0.5410057697380566, 0.5266017760721997, 0.5124062129662987, 0.4984269457245172, 0.48441359549807883, 0.4708026866672932, 0.4570528241298777, 0.4438902376356135, 0.4308049932988278, 0.41809597267719045, 0.40550624250182965, 0.39332812991028643, 0.38137942202310926, 0.369300936617456, 0.35753706337779967, 0.3461284397088815, 0.3347499663725495, 0.3238303024449385, 0.3128201875196024, 0.3020067051980102, 0.29162581460463466, 0.28161852595837145, 0.27165056383284814, 0.26194346762828946, 0.2524225169552641, 0.24310606419013503, 0.23388268419077818, 0.22515744012088224, 0.21646758991966664, 0.20785901452798905, 0.199629284619518, 0.19131565813345075, 0.18360372741482722, 0.17614872996508657, 0.16892706987178263, 0.16186927028158937, 0.15521653385510703, 0.14860967836949346, 0.14240133162745083, 0.13643025489392668, 0.13059944275106705, 0.12499803531256237, 0.11964831760685746, 0.11436414410238571, 0.10963840719253604, 0.10473176828724728, 0.10012270005561597, 0.09554247127253612, 0.0911811601216117, 0.08699157477796149, 0.08285311391127426, 0.0790305760945964, 0.07535747905675905, 0.07178663097286986, 0.06834424952342211, 0.06504868708475664, 0.06197466404631591, 0.05886393625517128, 0.05597868051631094, 0.05308687035733284, 0.050461169655413585, 0.04789708050265684, 0.04547849947666993, 0.043071716406917204, 0.04069639455375196, 0.03845609375515702, 0.03644781942897524, 0.03447100631939204, 0.032469286413328025, 0.030636670546491107, 0.02879618937550177, 0.027244102689982785, 0.025703813960697985, 0.02424086738889164, 0.02283035617807183, 0.021461793256050132, 0.020245292880916033, 0.019120554387530575, 0.01793551522900616, 0.016852725024418813, 0.015793530732277627, 0.014929658159856807, 0.014026459066684982, 0.013197980362933404, 0.012404895527851068, 0.011617054228874046, 0.010911798623469693, 0.010260289263075428, 0.009599603714516292, 0.008946783470098474, 0.008328046210337448, 0.007752568123398085, 0.007230836281479913, 0.006751052728359852, 0.006304041275861927, 0.005855718939329346, 0.005454588427711293, 0.005050836148035032, 0.004652327404452983, 0.004264305733081564, 0.003931341190743787, 0.0036272160969685885, 0.0033204692351351817, 0.0030242094455013024, 0.0027292605398909764, 0.0024867469952782884, 0.0022337463784660727, 0.0020226940504519675, 0.0018260614467191516, 0.0016831750879964247, 0.0015494649174607744, 0.0014262418191135495, 0.0012938425326014524, 0.0011876609265826232, 0.0010893446247162153, 0.0009884065547915988, 0.0008927120209722972, 0.0008166807475284976, 0.0007157426776038811, 0.000648887592336056, 0.0005649910147398352, 0.0005086230016715376, 0.0004679855968969804, 0.0004417679164037125, 0.0004207937720046573, 0.00038408901930075956, 0.0003434516145262023, 0.0003250992381853557, 0.0002975706736574324, 0.0002726638771877177, 0.00023071558838960726, 0.00021105232801410523, 0.00020056525581457763, 0.0001743475753102075, 0.0001533734309111523, 0.00013633193859385884, 0.00012846663444143758, 0.00011011425808948871, 0.00010093806992461651, 0.00009045099772508891, 0.00007734215746735273, 0.0000681659692913783, 0.0000589897811265061, 0.000053746245021191186, 0.000045880940868769926, 0.000036704752692795495, 0.000026217680493267892, 0.000022285028422608377, 0.000010487072199527603, 0.000003932652070659515, 0.0001]],
        dataY: [[158.0, 163.002475259901, 168.00495051980198, 173.00742577970297, 178.00990103960396, 183.01237629950495, 188.01485155940594, 193.01732681930693, 198.01980207920792, 203.0222773391089, 208.0247525990099, 213.0272278589109, 218.02970311881188, 223.03217837871287, 228.03465363861386, 233.03712889851485, 238.03960415841584, 243.04207941831683, 248.04455467821782, 253.0470299381188, 258.0495051980198, 263.05198045792076, 268.0544557178218, 273.0569309777228, 278.05940623762376, 283.0618814975247, 288.06435675742574, 293.06683201732676, 298.0693072772277, 303.0717825371287, 308.0742577970297, 313.0767330569307, 318.0792083168317, 323.08168357673264, 328.08415883663366, 333.0866340965347, 338.08910935643564, 343.0915846163366, 348.0940598762376, 353.09653513613864, 358.0990103960396, 363.10148565594056, 368.1039609158416, 373.1064361757426, 378.10891143564356, 383.1113866955445, 388.11386195544554, 393.11633721534656, 398.1188124752475, 403.1212877351485, 408.1237629950495, 413.1262382549505, 418.1287135148515, 423.13118877475245, 428.13366403465346, 433.1361392945545, 438.13861455445544, 443.1410898143564, 448.1435650742574, 453.14604033415844, 458.1485155940594, 463.15099085396037, 468.1534661138614, 473.1559413737624, 478.15841663366336, 483.1608918935643, 488.16336715346534, 493.16584241336636, 498.1683176732673, 503.1707929331683, 508.1732681930693, 513.1757434529703, 518.1782187128713, 523.1806939727722, 528.1831692326732, 533.1856444925743, 538.1881197524752, 543.1905950123762, 548.1930702722773, 553.1955455321782, 558.1980207920792, 563.2004960519802, 568.2029713118811, 573.2054465717822, 578.2079218316832, 583.2103970915841, 588.2128723514852, 593.2153476113862, 598.2178228712871, 603.2202981311881, 608.222773391089, 613.2252486509901, 618.2277239108911, 623.230199170792, 628.2326744306931, 633.2351496905941, 638.237624950495, 643.240100210396, 648.242575470297, 653.245050730198, 658.247525990099, 663.25000125, 668.252476509901, 673.254951769802, 678.257427029703, 683.2599022896039, 688.2623775495049, 693.264852809406, 698.2673280693069, 703.2698033292079, 708.272278589109, 713.2747538490099, 718.2772291089109, 723.2797043688118, 728.2821796287128, 733.2846548886139, 738.2871301485148, 743.2896054084158, 748.2920806683169, 753.2945559282178, 758.2970311881188, 763.2995064480198, 768.3019817079207, 773.3044569678218, 778.3069322277228, 783.3094074876237, 788.3118827475248, 793.3143580074258, 798.3168332673267, 803.3193085272277, 808.3217837871287, 813.3242590470297, 818.3267343069307, 823.3292095668317, 828.3316848267327, 833.3341600866337, 838.3366353465346, 843.3391106064356, 848.3415858663366, 853.3440611262376, 858.3465363861386, 863.3490116460396, 868.3514869059406, 873.3539621658416, 878.3564374257426, 883.3589126856435, 888.3613879455445, 893.3638632054456, 898.3663384653465, 903.3688137252475, 908.3712889851486, 913.3737642450495, 918.3762395049505, 923.3787147648515, 928.3811900247524, 933.3836652846535, 938.3861405445545, 943.3886158044554, 948.3910910643565, 953.3935663242574, 958.3960415841584, 963.3985168440594, 968.4009921039603, 973.4034673638614, 978.4059426237624, 983.4084178836633, 988.4108931435644, 993.4133684034654, 998.4158436633663, 1003.4183189232673, 1008.4207941831683, 1013.4232694430693, 1018.4257447029703, 1023.4282199628713, 1028.4306952227723, 1033.4331704826732, 1038.4356457425743, 1043.4381210024753, 1048.4405962623762, 1053.4430715222773, 1058.445546782178, 1063.4480220420792, 1068.4504973019802, 1073.4529725618813, 1078.4554478217822, 1083.457923081683, 1088.460398341584, 1093.4628736014852, 1098.4653488613862, 1103.467824121287, 1108.4702993811882, 1113.472774641089, 1118.47524990099, 1123.4777251608912, 1128.480200420792, 1133.482675680693, 1138.485150940594, 1143.487626200495, 1148.490101460396, 1153.4925767202972, 1158.495051980198, 1163.4975272400989, 1168.5000025, 1173.502477759901, 1178.504953019802, 1183.507428279703, 1188.509903539604, 1193.5123787995049, 1198.514854059406, 1203.517329319307, 1208.5198045792079, 1213.522279839109, 1218.5247550990098, 1223.5272303589109, 1228.529705618812, 1233.5321808787128, 1238.5346561386139, 1243.537131398515, 1248.5396066584158, 1253.5420819183169, 1258.544557178218, 1263.5470324381188, 1268.5495076980199, 1273.5519829579207, 1278.5544582178218, 1283.5569334777229, 1288.5594087376237, 1293.5618839975248, 1298.5643592574256, 1303.5668345173267, 1308.5693097772278, 1313.5717850371286, 1318.5742602970297, 1323.5767355569308, 1328.5792108168316, 1333.5816860767327, 1338.5841613366338, 1343.5866365965346, 1348.5891118564357, 1353.5915871163365, 1358.5940623762376, 1363.5965376361387, 1368.5990128960395, 1373.6014881559406, 1378.6039634158415, 1383.6064386757425, 1388.6089139356436, 1393.6113891955445, 1398.6138644554455, 1403.6163397153466, 1408.6188149752475, 1413.6212902351485, 1418.6237654950496, 1423.6262407549505, 1428.6287160148515, 1433.6311912747524, 1438.6336665346535, 1443.6361417945545, 1448.6386170544554, 1453.6410923143565, 1458.6435675742573, 1463.6460428341584, 1468.6485180940595, 1473.6509933539603, 1478.6534686138614, 1483.6559438737625, 1488.6584191336633, 1493.6608943935644, 1498.6633696534655, 1503.6658449133663, 1508.6683201732674, 1513.6707954331682, 1518.6732706930693, 1523.6757459529704, 1528.6782212128712, 1533.6806964727723, 1538.6831717326731, 1543.6856469925742, 1548.6881222524753, 1553.6905975123761, 1558.6930727722772, 1563.6955480321783, 1568.6980232920791, 1573.7004985519802, 1578.7029738118813, 1583.7054490717821, 1588.7079243316832, 1593.710399591584, 1598.7128748514851, 1603.7153501113862, 1608.717825371287, 1613.7203006311881, 1618.722775891089, 1623.72525115099, 1628.7277264108911, 1633.730201670792, 1638.732676930693, 1643.7351521905941, 1648.737627450495, 1653.740102710396, 1658.7425779702971, 1663.745053230198, 1668.747528490099, 1673.75000375, 1678.752479009901, 1683.754954269802, 1688.757429529703, 1693.759904789604, 1698.7623800495048, 1703.764855309406, 1708.767330569307, 1713.7698058292078, 1718.772281089109, 1723.77475634901, 1728.7772316089108, 1733.779706868812, 1738.782182128713, 1743.7846573886138, 1748.787132648515, 1753.7896079084157, 1758.7920831683168, 1763.794558428218, 1768.7970336881187, 1773.7995089480198, 1778.8019842079207, 1783.8044594678217, 1788.8069347277228, 1793.8094099876237, 1798.8118852475247, 1803.8143605074258, 1808.8168357673267, 1813.8193110272277, 1818.8217862871288, 1823.8242615470297, 1828.8267368069307, 1833.8292120668316, 1838.8316873267327, 1843.8341625866337, 1848.8366378465346, 1853.8391131064357, 1858.8415883663365, 1863.8440636262376, 1868.8465388861387, 1873.8490141460395, 1878.8514894059406, 1883.8539646658417, 1888.8564399257425, 1893.8589151856436, 1898.8613904455447, 1903.8638657054455, 1908.8663409653466, 1913.8688162252474, 1918.8712914851485, 1923.8737667450496, 1928.8762420049504, 1933.8787172648515, 1938.8811925247524, 1943.8836677846534, 1948.8861430445545, 1953.8886183044553, 1958.8910935643564, 1963.8935688242575, 1968.8960440841583, 1973.8985193440594, 1978.9009946039605, 1983.9034698638613, 1988.9059451237624, 1993.9084203836633, 1998.9108956435643, 2003.9133709034654, 2008.9158461633663, 2013.9183214232673, 2018.9207966831682, 2023.9232719430693, 2028.9257472029703, 2033.9282224628712, 2038.9306977227723, 2043.9331729826733, 2048.935648242574, 2053.9381235024753, 2058.9405987623763, 2063.943074022277, 2068.945549282178, 2073.948024542079, 2078.95049980198, 2083.9529750618813, 2088.9554503217823, 2093.9579255816834, 2098.960400841584, 2103.962876101485, 2108.965351361386, 2113.967826621287, 2118.970301881188, 2123.972777141089, 2128.97525240099, 2133.977727660891, 2138.980202920792, 2143.9826781806933, 2148.9851534405943, 2153.987628700495, 2158.990103960396, 2163.992579220297, 2168.9950544801977, 2173.997529740099, 2179.000005, 2184.002480259901, 2189.004955519802, 2194.007430779703, 2199.009906039604, 2204.0123812995053, 2209.014856559406, 2214.017331819307, 2219.019807079208, 2224.022282339109, 2229.0247575990097, 2234.027232858911, 2239.029708118812, 2244.032183378713, 2249.034658638614, 2254.0371338985146, 2259.0396091584157, 2264.042084418317, 2269.044559678218, 2274.047034938119, 2279.0495101980196, 2284.0519854579206, 2289.0544607178217, 2294.056935977723, 2299.059411237624, 2304.061886497525, 2309.0643617574256, 2314.0668370173266, 2319.0693122772277, 2324.071787537129, 2329.07426279703, 2334.0767380569305, 2339.0792133168316, 2344.0816885767326, 2349.0841638366337, 2354.086639096535, 2359.089114356436, 2364.0915896163365, 2369.0940648762376, 2374.0965401361386, 2379.0990153960397, 2384.101490655941, 2389.1039659158414, 2394.1064411757425, 2399.1089164356436, 2404.1113916955446, 2409.1138669554457, 2414.1163422153463, 2419.1188174752474, 2424.1212927351485, 2429.1237679950495, 2434.1262432549506, 2439.1287185148512, 2444.1311937747523, 2449.1336690346534, 2454.1361442945545, 2459.1386195544555, 2464.1410948143566, 2469.1435700742572, 2474.1460453341583, 2479.1485205940594, 2484.1509958539605, 2489.1534711138615, 2494.155946373762, 2499.1584216336632, 2504.1608968935643, 2509.1633721534654, 2514.1658474133665, 2519.1683226732675, 2524.170797933168, 2529.1732731930692, 2534.1757484529703, 2539.1782237128714, 2544.1806989727725, 2549.183174232673, 2554.185649492574, 2559.1881247524752, 2564.1906000123763, 2569.1930752722774, 2574.195550532178, 2579.198025792079, 2584.20050105198, 2589.2029763118812, 2594.2054515717823, 2599.207926831683, 2604.210402091584, 2609.212877351485, 2614.215352611386, 2619.217827871287, 2624.2203031311883, 2629.222778391089, 2634.22525365099, 2639.227728910891, 2644.230204170792, 2649.232679430693, 2654.235154690594, 2659.237629950495, 2664.240105210396, 2669.242580470297, 2674.245055730198, 2679.247530990099, 2684.25000625, 2689.252481509901, 2694.254956769802, 2699.257432029703, 2704.259907289604, 2709.2623825495048, 2714.264857809406, 2719.267333069307, 2724.269808329208, 2729.272283589109, 2734.2747588490097, 2739.2772341089108, 2744.279709368812, 2749.282184628713, 2754.284659888614, 2759.2871351485146, 2764.2896104084157, 2769.2920856683168, 2774.294560928218, 2779.297036188119, 2784.29951144802, 2789.3019867079206, 2794.3044619678217, 2799.3069372277228, 2804.309412487624, 2809.311887747525, 2814.3143630074255, 2819.3168382673266, 2824.3193135272277, 2829.3217887871288, 2834.32426404703, 2839.326739306931, 2844.3292145668315, 2849.3316898267326, 2854.3341650866337, 2859.3366403465348, 2864.339115606436, 2869.3415908663364, 2874.3440661262375, 2879.3465413861386, 2884.3490166460397, 2889.3514919059407, 2894.3539671658414, 2899.3564424257424, 2904.3589176856435, 2909.3613929455446, 2914.3638682054457, 2919.3663434653463, 2924.3688187252474, 2929.3712939851484, 2934.3737692450495, 2939.3762445049506, 2944.3787197648517, 2949.3811950247523, 2954.3836702846534, 2959.3861455445544, 2964.3886208044555, 2969.3910960643566, 2974.393571324257, 2979.3960465841583, 2984.3985218440594, 2989.4009971039604, 2994.4034723638615, 2999.4059476237626, 3004.408422883663, 3009.4108981435643, 3014.4133734034654, 3019.4158486633664, 3024.4183239232675, 3029.420799183168, 3034.423274443069, 3039.4257497029703, 3044.4282249628714, 3049.4307002227724, 3054.433175482673, 3059.435650742574, 3064.438126002475, 3069.4406012623763, 3074.4430765222774, 3079.445551782178, 3084.448027042079, 3089.45050230198, 3094.452977561881, 3099.4554528217823, 3104.4579280816833, 3109.460403341584, 3114.462878601485, 3119.465353861386, 3124.467829121287, 3129.4703043811883, 3134.472779641089, 3139.47525490099, 3144.477730160891, 3149.480205420792, 3154.482680680693, 3159.4851559405943, 3164.487631200495, 3169.490106460396, 3174.492581720297, 3179.495056980198, 3184.497532240099, 3189.5000075, 3194.502482759901, 3199.504958019802, 3204.507433279703, 3209.509908539604, 3214.5123837995047, 3219.514859059406, 3224.517334319307, 3229.519809579208, 3234.522284839109, 3239.5247600990097, 3244.5272353589107, 3249.529710618812, 3254.532185878713, 3259.534661138614, 3264.537136398515, 3269.5396116584157, 3274.5420869183167, 3279.544562178218, 3284.547037438119, 3289.54951269802, 3294.5519879579206, 3299.5544632178216, 3304.5569384777227, 3309.559413737624, 3314.561888997525, 3319.564364257426, 3324.5668395173266, 3329.5693147772276, 3334.5717900371287, 3339.57426529703, 3344.576740556931, 3349.5792158168315, 3354.5816910767326, 3359.5841663366336, 3364.5866415965347, 3369.589116856436, 3374.5915921163364, 3379.5940673762375, 3384.5965426361386, 3389.5990178960396, 3394.6014931559407, 3399.6039684158413, 3404.6064436757424, 3409.6089189356435, 3414.6113941955446, 3419.6138694554456, 3424.6163447153467, 3429.6188199752473, 3434.6212952351484, 3439.6237704950495, 3444.6262457549506, 3449.6287210148516, 3454.6311962747523, 3459.6336715346533, 3464.6361467945544, 3469.6386220544555, 3474.6410973143566, 3479.6435725742576, 3484.6460478341583, 3489.6485230940593, 3494.6509983539604, 3499.6534736138615, 3504.6559488737626, 3509.658424133663, 3514.6608993935643, 3519.6633746534653, 3524.6658499133664, 3529.6683251732675, 3534.670800433168, 3539.673275693069, 3544.6757509529702, 3549.6782262128713, 3554.6807014727724, 3559.683176732673, 3564.685651992574, 3569.688127252475, 3574.6906025123762, 3579.6930777722773, 3584.6955530321784, 3589.698028292079, 3594.70050355198, 3599.702978811881, 3604.7054540717822, 3609.7079293316833, 3614.710404591584, 3619.712879851485, 3624.715355111386, 3629.717830371287, 3634.7203056311882, 3639.7227808910893, 3644.72525615099, 3649.727731410891, 3654.730206670792, 3659.732681930693, 3664.7351571905942, 3669.737632450495, 3674.740107710396, 3679.742582970297, 3684.745058230198, 3689.747533490099, 3694.75000875, 3699.752484009901, 3704.754959269802, 3709.757434529703, 3714.759909789604, 3719.7623850495047, 3724.764860309406, 3729.767335569307, 3734.769810829208, 3739.772286089109, 3744.77476134901, 3749.7772366089107, 3754.779711868812, 3759.782187128713, 3764.784662388614, 3769.787137648515, 3774.7896129084156, 3779.7920881683167, 3784.7945634282178, 3789.797038688119, 3794.79951394802, 3799.801989207921, 3804.8044644678216, 3809.8069397277227, 3814.8094149876238, 3819.811890247525, 3824.814365507426, 3829.8168407673265, 3834.8193160272276, 3839.8217912871287, 3844.8242665470298, 3849.826741806931, 3854.8292170668315, 3859.8316923267325, 3864.8341675866336, 3869.8366428465347, 3874.8391181064358, 3879.8415933663364, 3884.8440686262375, 3889.8465438861385, 3894.8490191460396, 3899.8514944059407, 3904.8539696658418, 3909.8564449257424, 3914.8589201856435, 3919.8613954455445, 3924.8638707054456, 3929.8663459653467, 3934.8688212252473, 3939.8712964851484, 3944.8737717450495, 3949.8762470049505, 3954.8787222648516, 3959.8811975247527, 3964.8836727846533, 3969.8861480445544, 3974.8886233044555, 3979.8910985643565, 3984.8935738242576, 3989.896049084158, 3994.8985243440593, 3999.9009996039604, 4004.9034748638614, 4009.9059501237625, 4014.908425383663, 4019.910900643564, 4024.9133759034653, 4029.9158511633664, 4034.9183264232674, 4039.920801683168, 4044.923276943069, 4049.92575220297, 4054.9282274628713, 4059.9307027227724, 4064.9331779826734, 4069.935653242574, 4074.938128502475, 4079.940603762376, 4084.9430790222773, 4089.9455542821784, 4094.948029542079, 4099.95050480198, 4104.952980061881, 4109.955455321782, 4114.957930581683, 4119.960405841584, 4124.9628811014845, 4129.9653563613865, 4134.967831621287, 4139.970306881189, 4144.972782141089, 4149.97525740099, 4154.977732660891, 4159.980207920792, 4164.982683180693, 4169.985158440594, 4174.987633700495, 4179.990108960395, 4184.992584220297, 4189.995059480198, 4194.9975347401]],
        seriesLabels: ["DEM_UTM42"],
        xAxisLabel: "% Area Above",
        yAxisLabel: "Elevation",
        width: 600,
        height: 500,
        drawPoints: false,
        drawGridlines: true,
        drawLegend: false,
        drawGreyBackground: false,
        parentId: "graph"
      };
      function update(svg) {
        // which of the series labels is longest?
        var maxSeriesLabelLength = 0;
        var a;
        for (a = 0; a < plot.seriesLabels.length; a++) {
          var sl = plot.seriesLabels[a];
          if (sl.length > maxSeriesLabelLength) { maxSeriesLabelLength = sl.length; }
        }
        var plotLeftMargin = 70.0;
        var plotRightMargin = plot.drawLegend ? 65.0 + maxSeriesLabelLength * 7 : 50.0;
        var plotBottomMargin = 70.0;
        var plotTopMargin = 40.0;
        var plotWidth = plot.width - plotLeftMargin - plotRightMargin;
        var plotHeight = plot.height - plotBottomMargin - plotTopMargin;
        var originX = plotLeftMargin;
        var originY = plotTopMargin + plotHeight;
        var tickLen = 8.0;
        var minorTickLen = tickLen * 0.65;

        // If there are no series labels, treat it as one series.
        if (plot.seriesLabels.length === 0) {
					plot.drawLegend = false;
				}

        // colors
        var lineColor = '#47a3ff'; //'#377eb8'; // '#729ece'; // '#1f77b4'; //'#47a3ff'; //'rgb(2,145,205)';
        var highlightColor = '#ff7f00';
        var btnColor = 'rgb(170,170,170)';
        var btnHoverColor = 'rgb(150,150,150)';
        var plotBackgroundColor = 'rgb(255,255,255)';
        if (plot.drawGreyBackground) {
          plotBackgroundColor = '#CCC';
        }
        var chartBackgroundColor = 'white';
        // var gridLineColor = 'rgb(120,120,120)';
        // if (plot.drawGreyBackground) {
          var gridLineColor = '#EEE';
        // }
        var trendlineColor = 'DimGray';
        if (plot.drawGreyBackground) {
          trendlineColor = 'DimGray';
        }
        var showValueClr = "black";
        // if (plot.drawGreyBackground) {
        //   showValueClr = '#FFF';
        // }

        // Gridlines
        // var gridlineDash = '1, 5';
        // if (plot.drawGreyBackground) {
          var gridlineDash = 'none';
        // }

        var tableau20 = [[31, 119, 180], [255, 127, 14],
             [44, 160, 44], [214, 39, 40],
             [148, 103, 189], [140, 86, 75],
             [227, 119, 194], [127, 127, 127],
             [188, 189, 34], [23, 190, 207]];

        var regularOpacity = 1.0;
        var deselectedOpacity = 0.10;


        // create the svg element
        var svgns = "http://www.w3.org/2000/svg";
        if (svg == null) {
          svg = document.createElementNS(svgns, "svg");
        } else {
          while (svg.lastChild) {
              svg.removeChild(svg.lastChild);
          }
        }
        svg.setAttribute('width', `${plot.width}`);
        svg.setAttribute('height', `${plot.height}`);
        var div = document.getElementById(plot.parentId);
        if (div != null) {
          div.appendChild(svg);
        } else {
          // add it to the body of the document
          document.querySelector("body").appendChild(svg);
        }

        // how many series are there?
        var numSeries = plot.dataY.length;

        // if dataX is empty, fill it with the series 1, 2, 3, 4, ...
        if (plot.dataX.length == 0) {
          for (s = 0; s < numSeries; s++) {
            var seriesXData = [];
            for (a = 0; a < plot.dataY[s].length; a++) {
              seriesXData.push(a + 1);
            }
            plot.dataX.push(seriesXData);
          }
        }

        // style
        var style = document.createElement("style");
        let styleString = `
        text {
          font-family:Sans,Arial;
        }
        .axisLabel {
          font-weight: normal;
        }
        .xTickLabel {
          fill: black;
          font-size: 85%;
          font-weight: lighter;
        }
        .yTickLabel {
          fill: black;
          font-size: 85%;
          font-weight: lighter;
        }
        .gridLine {
          stroke: ${gridLineColor};
          stroke-dasharray: ${gridlineDash};
          stroke-width: 0.8;
        }
        .tick {
          stroke: black;
          stroke-width: 0.5;
        }
        #plotBorder {
          fill: none;
          stroke: black;
          stroke-width: 0.5;
        }
        #showValue {
          font-size: 85%;
          fill: ${showValueClr};
        }
        #context-menu {
          position:absolute;
          display:none;
        }
        #context-menu ul {
          list-style:none;
          margin:0;
          padding:0;
          background: #EFEFEF;
          opacity: 0.90;
        }
        #context-menu {
          border:solid 1px #CCC;
        }
        #context-menu li {
          font-family:Sans,Arial;
          font-size: 75%;
          text-align: left;
          color:#000;
          display:block;
          padding:5px 15px;
          border-bottom:solid 1px #CCC;
        }
        #context-menu li:last-child {
          border:none;
        }
        #context-menu li:hover {
          background:#007AFF;
          color:#FFF;
        }
        `;

        var dataPointHoverWidth = 4.0;
        if (!plot.drawPoints) {
          dataPointHoverWidth = 6.0;
        }
        var s;
        for (s = 0; s < numSeries; s++) {
          var clrNum = s % tableau20.length;
          if (plot.seriesLabels.length === 0) {
            // If there are no series labels, treat it as one series.
						clrNum = 0;
					}
          let clr = `rgb(${tableau20[clrNum][0]},${tableau20[clrNum][1]},${tableau20[clrNum][2]})`;

          styleString += `
          .seriesLine${s} {
            fill: none;
            stroke-width:1;
            stroke: ${clr};
            opacity: ${regularOpacity};
          }
          .seriesLine${s}:hover {
            fill: none;
            stroke-width:2;
            stroke: ${clr};
            opacity: ${regularOpacity};
          }
          .seriesLineThick${s} {
            fill: none;
            stroke-width:2;
            stroke: ${clr};
            opacity: ${regularOpacity};
          }
          .seriesLineThick${s}:hover {
            fill: none;
            stroke-width:3;
            stroke: ${clr};
            opacity: ${regularOpacity};
          }
          .dataPoint${s} {
            fill: ${clr};
            stroke-width:0;
            stroke: ${clr};
            opacity: ${regularOpacity};
          }
          .dataPoint${s}:hover {
            fill: red;
            stroke-width:${dataPointHoverWidth};
            stroke: red;
            opacity:1.0;
          }
          `;
        }
        style.innerHTML = styleString;
        svg.appendChild(style);
        svg.id = "plotSvg";

        // background
        var background = document.createElementNS(svgns, "rect");
        background.setAttribute('width', plot.width);
        background.setAttribute('height', plot.height);
        background.style.fill = chartBackgroundColor;
        svg.appendChild(background);

        // translate the origin point
        var g = document.createElementNS(svgns, "g");
        g.setAttribute('id', 'transform');
        g.setAttribute('transform', `translate(${originX},${originY})`);
        svg.appendChild(g);

        // plot background
        var plotBackground = document.createElementNS(svgns, "rect");
        plotBackground.setAttribute('id', 'plotBackground');
        plotBackground.setAttribute('x', 0.0);
        plotBackground.setAttribute('y', -plotHeight);
        plotBackground.setAttribute('width', plotWidth);
        plotBackground.setAttribute('height', plotHeight);
        plotBackground.style.fill = plotBackgroundColor;
        plotBackground.style.stroke = "none";
        g.appendChild(plotBackground);

        // what are the min/max values?
        var xMin = Infinity;
        var xMax = -Infinity;
        var yMin = Infinity;
        var yMax = -Infinity;
        var val = 0;
        var maxNumPoints = 0;
        var totalNumPoints = 0;
        for (s = 0; s < numSeries; s++) {
          var numPoints = Math.min(plot.dataX[s].length, plot.dataY[s].length);
          if (numPoints > maxNumPoints) { maxNumPoints = maxNumPoints; }
          totalNumPoints += numPoints;
          if (numPoints < 2) {
            alert("Too few points for line graph");
            return;
          }
          if (plot.dataX[s].length != plot.dataY[s].length) {
            alert("The x and y data arrays are unequal in length.");
          }
          for (a = 0; a < numPoints; a++) {
              val = plot.dataX[s][a];
              if (val < xMin) { xMin = val; }
              if (val > xMax) { xMax = val; }
              val = plot.dataY[s][a];
              if (val < yMin) { yMin = val; }
              if (val > yMax) { yMax = val; }
          }
        }

        // We don't want a data point to fall on the plot border
        xMin -= 0.0000001;
        yMin -= 0.0000001;
        xMax += 0.0000001;
        yMax += 0.0000001;

        // X axis
        var xAxisTickSpacing = 0.0000001;
        var xAxisNumTicks = 1000;
        var xRange = xMax - xMin;
        a = 0;
        while (xAxisNumTicks > 20) {
          if (a % 2 == 0) {
            xAxisTickSpacing *= 5.0;
          } else {
            xAxisTickSpacing *= 2.0;
          }
          a++;
          xAxisNumTicks = Math.ceil(xRange / xAxisTickSpacing);
        }
        xMin = Math.floor(xMin / xAxisTickSpacing) * xAxisTickSpacing;
        xAxisNumTicks = Math.ceil((xMax - xMin) / xAxisTickSpacing);
        xRange = xAxisTickSpacing * xAxisNumTicks;
        var xSigDigits = Math.min(decimalPlaces(xMin+xAxisTickSpacing), decimalPlaces(xMin+2*xAxisTickSpacing)); //Math.round(0.1 / xAxisTickSpacing);
        var dominantTick = 0;
        if (decimalPlaces(xMin) > decimalPlaces(xMin+xAxisTickSpacing)) {
          dominantTick = 1;
        }
        for (a = 0; a <= xAxisNumTicks; a++) {
            // grid line
            if (plot.drawGridlines) {
              if (xAxisNumTicks <= 10 || a % 2 == dominantTick) {
                if (a > 0 && a < xAxisNumTicks) {
                  var line = document.createElementNS(svgns, "line");
                  line.setAttribute('x1', (a * xAxisTickSpacing) / xRange * plotWidth);
                  line.setAttribute('y1', 0);
                  line.setAttribute('x2', (a * xAxisTickSpacing) / xRange * plotWidth);
                  line.setAttribute('y2', -plotHeight);
                  line.setAttribute('class', 'gridLine');
                  g.appendChild(line);
                }
              }
            }
            // tick mark
            var line = document.createElementNS(svgns, "line");
            line.setAttribute('x1', (a * xAxisTickSpacing) / xRange * plotWidth);
            line.setAttribute('y1', 0);
            line.setAttribute('x2', (a * xAxisTickSpacing) / xRange * plotWidth);
            if (xAxisNumTicks <= 10 || a % 2 == dominantTick) {
              line.setAttribute('y2', tickLen);
            } else {
              line.setAttribute('y2', minorTickLen);
            }
            line.setAttribute('class', 'tick');
            g.appendChild(line);

            // labels
            if (xAxisNumTicks <= 10 || a % 2 == dominantTick) {
                // tick label
                var label = document.createElementNS(svgns, "text");
                label.setAttribute('x', (a * xAxisTickSpacing) / xRange * plotWidth);
                label.setAttribute('y', tickLen + 5);
                label.setAttribute('text-anchor', 'middle');
                label.setAttribute('dominant-baseline', 'hanging');
                label.setAttribute('class', 'xTickLabel');
                label.innerHTML = `${(xMin + a * xAxisTickSpacing).toFixed(xSigDigits)}`;
                g.appendChild(label);
            }
        }

        // Y axis
        var yAxisTickSpacing = 0.0000001;
        var yAxisNumTicks = 1000;
        var yRange = yMax - yMin;
        a = 0;
        while (yAxisNumTicks > 20) {
          if (a % 2 == 0) {
            yAxisTickSpacing *= 5.0;
          } else {
            yAxisTickSpacing *= 2.0;
          }
          a++;
          yAxisNumTicks = Math.ceil(yRange / yAxisTickSpacing);
        }
        yMin = Math.floor(yMin / yAxisTickSpacing) * yAxisTickSpacing;
        yAxisNumTicks = Math.ceil((yMax - yMin) / yAxisTickSpacing);
        yRange = yAxisTickSpacing * yAxisNumTicks;
        var ySigDigits = Math.min(decimalPlaces(yMin+yAxisTickSpacing), decimalPlaces(yMin+2*yAxisTickSpacing));
        dominantTick = 0;
        if (decimalPlaces(yMin) > decimalPlaces(yMin+yAxisTickSpacing)) {
          dominantTick = 1;
        }
        for (a = 0; a <= yAxisNumTicks; a++) {
            // grid line
            if (plot.drawGridlines) {
              if (yAxisNumTicks <= 10 || a % 2 == dominantTick) {
                if (a > 0 && a < yAxisNumTicks) {
                  var line = document.createElementNS(svgns, "line");
                  line.setAttribute('x1', 0); //(a * xAxisTickSpacing) / xRange * plotWidth);
                  line.setAttribute('y1', -(a * yAxisTickSpacing) / yRange * plotHeight);
                  line.setAttribute('x2', plotWidth); //(a * xAxisTickSpacing) / xRange * plotWidth);
                  line.setAttribute('y2', -(a * yAxisTickSpacing) / yRange * plotHeight); //-plotHeight);
                  line.setAttribute('class', 'gridLine');
                  g.appendChild(line);
                }
              }
            }
            // tick mark
            var line = document.createElementNS(svgns, "line");
            line.setAttribute('x1', 0);
            line.setAttribute('y1', -(a * yAxisTickSpacing) / yRange * plotHeight);
            if (yAxisNumTicks <= 6 || a % 2 == dominantTick) {
              line.setAttribute('x2', -tickLen);
            } else {
              line.setAttribute('x2', -minorTickLen);
            }
            line.setAttribute('y2', -(a * yAxisTickSpacing) / yRange * plotHeight);
            line.setAttribute('class', 'tick');
            g.appendChild(line);

            // labels
            if (yAxisNumTicks <= 6 || a % 2 == dominantTick) {
                // s += `<text transform="translate(${-tickLen - 5}, ${-(a * yAxisTickSpacing) / maxVal * plotHeight}), rotate(270)" x="0" y="0" text-anchor="middle" dominant-baseline="no-change" class="yTickLabel">${(a * yAxisTickSpacing).toFixed(ySigDigits)}</text>`;
                var label = document.createElementNS(svgns, "text");
                label.setAttribute('transform', `translate(${-tickLen - 5},${-(a * yAxisTickSpacing) / yRange * plotHeight}), rotate(270)`);
                label.setAttribute('x', 0);
                label.setAttribute('y', 0);
                label.setAttribute('text-anchor', 'middle');
                label.setAttribute('dominant-baseline', 'no-change');
                label.setAttribute('class', 'yTickLabel');
                label.innerHTML = `${(yMin + a * yAxisTickSpacing).toFixed(ySigDigits)}`;
                g.appendChild(label);
            }
        }

        // axis labels
        var xLabel = document.createElementNS(svgns, "text");
        xLabel.setAttribute('x', plotWidth / 2.0);
        xLabel.setAttribute('y', tickLen + 25.0);
        xLabel.setAttribute('text-anchor', 'middle');
        xLabel.setAttribute('dominant-baseline', 'hanging');
        xLabel.setAttribute('class', 'axisLabel');
        xLabel.innerHTML = plot.xAxisLabel;
        g.appendChild(xLabel);

        var yLabel = document.createElementNS(svgns, "text");
        yLabel.setAttribute('transform', `translate(${-tickLen - 28.0},${-plotHeight / 2.0}), rotate(270)`);
        yLabel.setAttribute('x', 0);
        yLabel.setAttribute('y', 0);
        yLabel.setAttribute('text-anchor', 'middle');
        yLabel.setAttribute('class', 'axisLabel');
        yLabel.innerHTML = plot.yAxisLabel;
        g.appendChild(yLabel);

        // text to show values when hover over
        var showValue = document.createElementNS(svgns, "text");
        showValue.setAttribute('x', 10);
        showValue.setAttribute('text-anchor', 'start');

        // draw the line(s)
        var g2 = document.createElementNS(svgns, "g");
        g2.setAttribute('id', 'lines');
        g.appendChild(g2);

        var radius = 3.0;
        if (totalNumPoints > 15) { radius = 2.5; }
        if (!plot.drawPoints) {
          radius = 1.0;
        }
        for (let s = 0; s < numSeries; s++) {
          var numPoints = Math.min(plot.dataX[s].length, plot.dataY[s].length);
          let seriesLine = document.createElementNS(svgns, "polyline");
          var pointsString = `${(plot.dataX[s][0] - xMin) / xRange * plotWidth},${-(plot.dataY[s][0] - yMin) / yRange * plotHeight}`;
          for (let a = 1; a < numPoints; a++) {
            pointsString += ` ${(plot.dataX[s][a] - xMin) / xRange * plotWidth},${-(plot.dataY[s][a] - yMin) / yRange * plotHeight}`
          }
          seriesLine.setAttribute('points', pointsString);
          var seriesLabel = "seriesLine";
          if (!plot.drawPoints) { seriesLabel = "seriesLineThick"; }
          seriesLine.setAttribute('class', `${seriesLabel}${s}`);
          seriesLine.addEventListener('mouseover', function() {
            var s2;
            for (s2 = 0; s2 < numSeries; s2++) {
              if (s2 != s) {
                var x = document.getElementsByClassName(`${seriesLabel}${s2}`);
                var i;
                for (i = 0; i < x.length; i++) {
                  x[i].style.opacity = deselectedOpacity;
                }
                x = document.getElementsByClassName(`dataPoint${s2}`);
                for (i = 0; i < x.length; i++) {
                    x[i].style.opacity = deselectedOpacity;
                }
              }
            }
          }, false);
          seriesLine.addEventListener('mouseout', function() {
            var s2;
            for (s2 = 0; s2 < numSeries; s2++) {
              if (s2 != s) {
                var x = document.getElementsByClassName(`${seriesLabel}${s2}`);
                var i;
                for (i = 0; i < x.length; i++) {
                  x[i].style.opacity = regularOpacity;
                }
                x = document.getElementsByClassName(`dataPoint${s2}`);
                for (i = 0; i < x.length; i++) {
                    x[i].style.opacity = regularOpacity;
                }
              }
            }
          }, false);
          g2.appendChild(seriesLine);

          // draw the data points
          for (let a = 0; a < numPoints; a++) {
            let c = document.createElementNS(svgns, "circle");
            c.setAttribute('cx', `${(plot.dataX[s][a] - xMin) / xRange * plotWidth}`);
            c.setAttribute('cy', `${-(plot.dataY[s][a] - yMin) / yRange * plotHeight}`);
            c.setAttribute('r', radius);
            c.setAttribute('class', `dataPoint${s}`);
            c.addEventListener('mouseover', function() {
              var s2;
              for (s2 = 0; s2 < numSeries; s2++) {
                if (s2 != s) {
                  var x = document.getElementsByClassName(`${seriesLabel}${s2}`);
                  var i;
                  for (i = 0; i < x.length; i++) {
                    x[i].style.opacity = deselectedOpacity;
                  }
                  x = document.getElementsByClassName(`dataPoint${s2}`);
                  for (i = 0; i < x.length; i++) {
                      x[i].style.opacity = deselectedOpacity;
                  }
                }
              }
              showValue.innerHTML = `x: ${(plot.dataX[s][a]).toFixed(xSigDigits+2)}, y: ${(plot.dataY[s][a]).toFixed(ySigDigits+2)}`;
            }, false);
            c.addEventListener('mouseout', function() {
              var s2;
              for (s2 = 0; s2 < numSeries; s2++) {
                if (s2 != s) {
                  var x = document.getElementsByClassName(`${seriesLabel}${s2}`);
                  var i;
                  for (i = 0; i < x.length; i++) {
                    x[i].style.opacity = regularOpacity;
                  }
                  x = document.getElementsByClassName(`dataPoint${s2}`);
                  for (i = 0; i < x.length; i++) {
                      x[i].style.opacity = regularOpacity;
                  }
                }
              }
              showValue.innerHTML = "";
            }, false);
            g2.appendChild(c);
          }
        }

        // Show value label
        showValue.setAttribute('id', 'showValue');
        showValue.setAttribute('y', -plotHeight + 20);
        g.appendChild(showValue);

        // plot border
        var plotBorder = document.createElementNS(svgns, "rect");
        plotBorder.setAttribute('x', 0);
        plotBorder.setAttribute('y', -plotHeight);
        plotBorder.setAttribute('width', plotWidth);
        plotBorder.setAttribute('height', plotHeight);
        plotBorder.id = "plotBorder";
        g.appendChild(plotBorder);

        // add a legend
        if (plot.seriesLabels.length > 0 && plot.drawLegend) {
          var legend = document.createElementNS(svgns, "g");
          legend.setAttribute('id', 'legend');
          g.appendChild(legend);
          for (let s = 0; s < numSeries; s++) {
            var y = -(plotHeight - 35 - 23 * (s+1));
            var line = document.createElementNS(svgns, "line");
            line.setAttribute('x1', plotWidth + 10);
            line.setAttribute('y1', y);
            line.setAttribute('x2', plotWidth + 40);
            line.setAttribute('y2', y);
            if (plot.drawPoints) {
              line.setAttribute('class', `seriesLine${s}`);
            } else {
              line.setAttribute('class', `seriesLineThick${s}`);
            }
            legend.appendChild(line);

            if (plot.drawPoints) {
              var c = document.createElementNS(svgns, "circle");
              c.setAttribute('cx', plotWidth+25);
              c.setAttribute('cy', y);
              c.setAttribute('r', radius);
              c.setAttribute('class', `dataPoint${s}`);
              legend.appendChild(c);
            }

            var legendLabel = document.createElementNS(svgns, "text");
            legendLabel.setAttribute('x', plotWidth + 48);
            legendLabel.setAttribute('y', y);
            legendLabel.setAttribute('text-anchor', 'left');
            // legendLabel.setAttribute('text-anchor', 'middle');
            legendLabel.setAttribute('dominant-baseline', 'middle');
            legendLabel.setAttribute('class', 'xTickLabel');
            legendLabel.innerHTML = plot.seriesLabels[s];
            legend.appendChild(legendLabel);
          }
        }

        // Add an invisible context menu to the parentId.
        var cm = document.createElement('div');
        cm.id = 'context-menu';
        cm.className = 'context-menu';
        var list = document.createElement('ul');

        var copyBtn = document.createElement("li");
        copyBtn.innerHTML = "Copy";
        copyBtn.addEventListener('click', function() {
          var content = `<svg xmlns='${svgns}' width='${plot.width}' height='${plot.height}'>\n${svg.innerHTML}\n</svg>`;
          // Create an auxiliary hidden input
          var aux = document.createElement("input");
          // Get the text from the element passed into the input
          aux.setAttribute("value", content);
          // Append the aux input to the body
          document.body.appendChild(aux);
          // Highlight the content
          aux.select();
          // Execute the copy command
          document.execCommand("copy");
          // Remove the input from the body
          document.body.removeChild(aux);
          // Give a notification
          alert("The plot's SVG content has been copied to the clipboard.");
        }, false);
        list.appendChild(copyBtn);

        var gridlineBtn = document.createElement("li");
        var verb = plot.drawGridlines ? "Hide " : "Show ";
        gridlineBtn.innerHTML = verb + "Gridlines";
        gridlineBtn.addEventListener('click', function() {
          plot.drawGridlines = !plot.drawGridlines;
          // update the context menu label
          var verb = plot.drawGridlines ? "Hide " : "Show ";
          gridlineBtn.innerHTML = verb + "Gridlines";
          update(svg);
        }, false);
        list.appendChild(gridlineBtn);

        if (plot.seriesLabels.length > 0) {
          var legendBtn = document.createElement("li");
          var verb = plot.drawLegend ? "Hide " : "Show ";
          legendBtn.innerHTML = verb + "Legend";
          legendBtn.addEventListener('click', function() {
            plot.drawLegend = !plot.drawLegend;
            // update the context menu label
            var verb = plot.drawLegend ? "Hide " : "Show ";
            legendBtn.innerHTML = verb + "Legend";
            update(svg);
          }, false);
          list.appendChild(legendBtn);
        }

        var pointsBtn = document.createElement("li");
        var verb = plot.drawPoints ? "Hide " : "Show ";
        pointsBtn.innerHTML = verb + "Points";
        pointsBtn.addEventListener('click', function() {
          plot.drawPoints = !plot.drawPoints;
          // update the context menu label
          var verb = plot.drawPoints ? "Hide " : "Show ";
          pointsBtn.innerHTML = verb + "Points";
          update(svg);
        }, false);
        list.appendChild(pointsBtn);

        var backgroundColorBtn = document.createElement("li");
        var verb = plot.drawGreyBackground ? "Light " : "Dark ";
        backgroundColorBtn.innerHTML = verb + "Background";
        backgroundColorBtn.addEventListener('click', function() {
          plot.drawGreyBackground = !plot.drawGreyBackground;
          // update the context menu label
          var verb = plot.drawGreyBackground ? "Light " : "Dark ";
          backgroundColorBtn.innerHTML = verb + "Background";
          update(svg);
        }, false);
        list.appendChild(backgroundColorBtn);

        cm.appendChild(list);
        document.getElementById(plot.parentId).appendChild(cm);

        var menu = document.getElementById('context-menu');
        document.onclick = function () {
            menu.style.display = 'none';
        };

        document.getElementById('plotSvg').oncontextmenu = function (evt) {
            evt = (evt) ? evt : ((event) ? event : null);
            var posnX = (evt.pageX) ? evt.pageX : ((evt.offsetX) ? evt.offsetX + 10 : null);
            var posnY = (evt.pageY) ? evt.pageY : ((evt.offsetY) ? evt.offsetY + 10 : null);
            menu.style.left = posnX + 'px';
            menu.style.top = posnY + 'px';
            menu.style.display = 'block';
            if (typeof evt.preventDefault != "undefined") {
                evt.preventDefault();
            } else {
                evt.returnValue = false;
            }
        };
      }

      function decimalPlaces(num) {
        var match = (''+num).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);
        if (!match) { return 0; }
        return Math.max(
             0,
             // Number of digits right of decimal point.
             (match[1] ? match[1].length : 0)
             // Adjust for scientific notation.
             - (match[2] ? +match[2] : 0));
      }

      update(null);
    </script></div></body>